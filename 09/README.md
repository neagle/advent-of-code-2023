I always feel good if part 2 goes really quickly. Makes me feel like maybe I
solved part 1 in a particularly flexible way.

To be honest, this one felt pretty easy: there really wasn't anything to figure
out: the problem itself showed quite clearly how to perform the operations that
needed to happen. It was purely a matter of coding it in an effective way.

Making the function to create histories recursive felt like the most natural
first thing to try, and it seemed to work well.
